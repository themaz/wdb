/*! wdb 2017-01-16 */
var History,Interpreter,Log,Prompt,Source,Switch,Traceback,Watchers,Wdb,Websocket,help,extend=function(a,b){function c(){this.constructor=a}for(var d in b)hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.substr(b,a.length)===a}),document.createElement("dialog").showModal||$(function(){return $("head").append($("<script>",{src:"https://cdnjs.cloudflare.com/ajax/libs/dialog-polyfill/0.4.3/dialog-polyfill.min.js"})),$("head").append($("<link>",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/dialog-polyfill/0.4.3/dialog-polyfill.min.css"}))}),Log=function(){function a(){this.debug=$("body").attr("data-debug")||!1}return a.prototype.time=function(){var a;return a=new Date,a.getHours()+":"+a.getMinutes()+":"+(a.getSeconds()+"."+a.getMilliseconds())},a.prototype.log=function(){var a,b;if(this.debug)return b="["+this.constructor.name+"] ("+this.time()+")",a=[b].concat(Array.prototype.slice.call(arguments,0)),console.log.apply(console,a)},a.prototype.dbg=function(){var a,b;if(this.debug)return b="["+this.constructor.name+"] ("+this.time()+")",a=[b].concat(Array.prototype.slice.call(arguments,0)),console.debug.apply(console,a)},a.prototype.fail=function(){var a,b;return b=this.constructor.name,a=[b].concat(Array.prototype.slice.call(arguments,0)),console.error.apply(console,a)},a}(),Websocket=function(a){function b(a,c){this.wdb=a,b.__super__.constructor.apply(this,arguments),this.url="ws://"+document.location.host+"/websocket/"+c,this.log("Opening new socket",this.url),this.ws=new WebSocket(this.url),this.ws.onclose=this.close.bind(this),this.ws.onopen=this.open.bind(this),this.ws.onerror=this.error.bind(this),this.ws.onmessage=this.message.bind(this)}return extend(b,a),b.prototype.close=function(a){return this.log("Closed",a),this.wdb.die()},b.prototype.error=function(a){return this.fail("Error",a)},b.prototype.open=function(a){return this.log("Open",a),this.wdb.opening()},b.prototype.message=function(a){var b,c,d,e;return d=a.data,e=d.indexOf("|"),e>-1?(b=d.substr(0,e),c=JSON.parse(d.substr(e+1))):b=d,this.dbg(this.time(),"<-",d),b=b.toLowerCase(),b in this.wdb?this.wdb[b.toLowerCase()](c):this.fail("Unknown command",b)},b.prototype.send=function(a,b){var c;return null==b&&(b=null),b?("string"!=typeof b&&(b=JSON.stringify(b)),c=a+"|"+b):c=a,this.dbg("->",c),this.ws.send(c)},b}(Log),Source=function(a){function b(a){this.wdb=a,b.__super__.constructor.apply(this,arguments),this.$container=$(".source").on("mousedown",function(a){return function(b){if(2===b.which&&a.code_mirror.getOption("readOnly"))return a.code_mirror.setOption("readOnly","nocursor")}}(this)).on("mouseup",function(a){return function(b){if(2===b.which)return a.code_mirror.setOption("readOnly",!0),a.wdb.paste_target(b)}}(this)),this.code_mirror=CodeMirror(function(a){return function(b){return a.$code_mirror=$(b),a.$container.prepend(b)}}(this),{value:"No active file",theme:"material",readOnly:!0,gutters:["breaks","CodeMirror-linenumbers"],lineNumbers:!0,extraKeys:{Esc:this.stop_edition.bind(this),"Ctrl-S":this.save.bind(this)}}),this.code_mirror.on("gutterClick",this.gutter_click.bind(this)),$(window).on("resize",this.size.bind(this)),this.state={fn:null,file:null,fun:null,lno:0},this.fun_scope=null,this.footsteps={},this.breakpoints={}}return extend(b,a),b.prototype.external=function(a){var b,c;return null==a&&(a=!0),b=this.code_mirror.getCursor(),c=""+this.state.fn,a&&(c=c+":"+(b.line+1)+":"+(b.ch+1)),this.wdb.ws.send("External",c)},b.prototype.save=function(){var a;if(!this.code_mirror.getOption("readOnly"))return a=this.code_mirror.getValue(),this.wdb.ws.send("Save",this.state.fn+"|"+a),this.state.file=a},b.prototype.gutter_click=function(a,b){return this.wdb.toggle_break(":"+(b+1))},b.prototype.clear_breakpoint=function(a){var b,c;if(null==(b=this.breakpoints)[c=a.fn]&&(b[c]=[]),indexOf.call(this.breakpoints[a.fn],a)>=0&&this.breakpoints[a.fn].splice(this.breakpoints[a.fn].indexOf(a)),a.lno)return this.remove_mark(a.lno),this.remove_class(a.lno,"ask-breakpoint"),this.remove_class(a.lno,"breakpoint")},b.prototype.ask_breakpoint=function(a){return this.add_class(a,"ask-breakpoint")},b.prototype.set_breakpoint=function(a){var b,c;return null==(b=this.breakpoints)[c=a.fn]&&(b[c]=[]),this.breakpoints[a.fn].push(a),this.mark_breakpoint(a)},b.prototype.mark_breakpoint=function(a){if(a.lno)return this.remove_class(a.lno,"ask-breakpoint"),this.add_class(a.lno,"breakpoint"),this.add_mark(a.lno,"breakpoint","breaks",a.temporary?"○":"●",this.brk_to_str(a))},b.prototype.brk_to_str=function(a){var b;return b=a.temporary?"Temporary ":"",b+="Breakpoint",a.fun&&(b+=" On "+a.fun),a.lno&&(b+=" At "+a.lno),a.cond&&(b+=" If "+a.cond),b},b.prototype.get_selection=function(){return this.code_mirror.getSelection().trim()},b.prototype.get_breakpoint=function(a){var b,c,d,e,f,g;for(null==(b=this.breakpoints)[f=this.state.fn]&&(b[f]=[]),g=this.breakpoints[this.state.fn],d=0,e=g.length;d<e;d++)if(c=g[d],c.lno===a)return c},b.prototype.add_class=function(a,b){return this.code_mirror.addLineClass(a-1,"background",b)},b.prototype.remove_class=function(a,b){return this.code_mirror.removeLineClass(a-1,"background",b)},b.prototype.add_mark=function(a,b,c,d,e){return this.code_mirror.setGutterMarker(a-1,c,$("<div>",{class:b,title:e}).html(d).get(0))},b.prototype.remove_mark=function(a){return this.code_mirror.setGutterMarker(a-1,"breaks",null)},b.prototype.stop_edition=function(){if(!this.code_mirror.getOption("readOnly"))return this.toggle_edition()},b.prototype.toggle_edition=function(){var a;if(a=this.code_mirror.getOption("readOnly"),this.code_mirror.setOption("readOnly",!a),this.$code_mirror.toggleClass("rw","ro"),this.wdb.print({for:"Toggling edition",result:"Edit mode "+(a?"on":"off")}),!a)return this.code_mirror.setValue(this.state.file)},b.prototype.open=function(a,b){var c;return c={fn:a.name,file:a.file||b.code,fun:b.function,lno:b.lno,flno:b.flno,llno:b.llno},this.set_state(c)},b.prototype.set_state=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(r=!0,this.state.fn!==a.fn||this.state.file!==a.file)for(this.code_mirror.setOption("mode",this.get_mode(a.fn)),this.code_mirror.setValue(a.file),l=this.breakpoints[a.fn]||[],d=0,g=l.length;d<g;d++)c=l[d],this.mark_breakpoint(c);else if(this.state.fun!==a.fun){if("<module>"!==this.state.fun){for(this.remove_class(this.state.flno,"ctx-top"),i=e=m=this.state.flno,n=this.state.llno;m<=n?e<=n:e>=n;i=m<=n?++e:--e)this.remove_class(i,"ctx");this.remove_class(this.state.llno,"ctx-bottom")}}else r=!1;for(this.state=a,this.code_mirror.clearGutter("CodeMirror-linenumbers"),o=this.footsteps[this.state.fn]||[],f=0,h=o.length;f<h;f++)s=o[f],this.remove_class(s,"highlighted"),this.add_class(s,"footstep");if(r&&"<module>"!==this.state.fun){for(this.add_class(this.state.flno,"ctx-top"),i=k=p=this.state.flno,q=this.state.llno;p<=q?k<=q:k>=q;i=p<=q?++k:--k)this.add_class(i,"ctx");this.add_class(this.state.llno,"ctx-bottom")}return this.add_class(this.state.lno,"highlighted"),this.add_mark(this.state.lno,"highlighted","CodeMirror-linenumbers","➤"),null==(b=this.footsteps)[j=this.state.fn]&&(b[j]=[]),this.footsteps[this.state.fn].push(this.state.lno),this.code_mirror.scrollIntoView({line:this.state.lno,ch:1},this.$code_mirror.height()/2),this.code_mirror.refresh()},b.prototype.get_mode=function(a){switch(a.split(".").splice(-1)[0]){case"py":return"python";case"jinja2":return"jinja2";case"diff":return"diff";default:return"python"}},b.prototype.focused=function(){return this.$code_mirror.hasClass("CodeMirror-focused")},b.prototype.size=function(){return this.$code_mirror.height(0),this.$code_mirror.height(this.$container.height()),this.code_mirror.refresh()},b}(Log),History=function(a){function b(a){var c;this.prompt=a,b.__super__.constructor.apply(this,arguments),this.index=-1,this.current="",this.currentPos=CodeMirror.Pos(0,0),this.oldIndex=null,this.originalIndex=null,this.overlay=null;try{this.history=JSON.parse(localStorage.history||"[]")}catch(a){c=a,this.fail(c),this.history=[]}this.sessionIndexStart=this.history.filter(function(a){return 0!==a.indexOf(".")}).length}return extend(b,a),b.prototype.up=function(){return this.index===-1&&this.saveCurrent(),this.index=Math.min(this.history.length-1,this.index+1),this.sync()},b.prototype.down=function(){return this.index=Math.max(this.index-1,-1),this.sync()},b.prototype.saveCurrent=function(){return this.current=this.prompt.get(),this.currentPos=this.prompt.code_mirror.getCursor()},b.prototype.sync=function(){return this.index===-1?(this.prompt.set(this.current),this.prompt.code_mirror.setCursor(this.currentPos)):(this.prompt.set(this.history[this.index]),this.prompt.code_mirror.setCursor(this.prompt.code_mirror.lineCount(),0))},b.prototype.historize=function(a){var b;if(a){for(;(b=this.history.indexOf(a))!==-1;)this.history.splice(b,1);return this.history.unshift(a),localStorage&&(localStorage.history=JSON.stringify(this.history))}},b.prototype.reset=function(){return this.index=-1,this.current="",this.currentPos=CodeMirror.Pos(0,0)},b.prototype.clear=function(){return this.history=[],this.sessionIndexStart=0,this.reset()},b.prototype.getOverlay=function(a){return{token:function(b){var c;return a.lastIndex=b.pos,c=a.exec(b.string),c&&c.index===b.pos?(b.pos+=c[0].length||1,"searching"):void(c?b.pos=c.index:b.skipToEnd())}}},b.prototype.searchPrev=function(a){return this.searchNext(a,-1)},b.prototype.searchNext=function(a,b){var c;for(null==b&&(b=1),null==this.oldIndex&&(this.oldIndex=this.index),null==this.originalIndex&&(this.originalIndex=this.index,this.index===-1&&this.saveCurrent());1===b&&this.index<this.history.length||b===-1&&this.index>-1;)if(this.index+=b,c=new RegExp("("+a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")","gi"),c.test(this.history[this.index]))return this.lastResult=this.index,this.sync(),null!=this.overlay&&this.prompt.code_mirror.removeOverlay(this.overlay,!0),this.overlay=this.getOverlay(c),this.prompt.code_mirror.addOverlay(this.overlay),!0;return!1},b.prototype.commitSearch=function(){return this.oldIndex=null,this.originalIndex=null,this.index=this.lastResult,this.sync()},b.prototype.rollbackSearch=function(){return this.oldIndex=null,null!=this.originalIndex&&(this.index=this.originalIndex),this.originalIndex=null,null!=this.overlay&&this.prompt.code_mirror.removeOverlay(this.overlay,!0),this.overlay=null,this.sync()},b.prototype.resetSearch=function(){return null!=this.oldIndex&&(this.index=this.oldIndex),this.oldIndex=null},b.prototype.getSessionHistory=function(){return this.history.slice(0,this.history.length-this.sessionIndexStart)},b.prototype.getHistory=function(a){var b,c;return b=0,c=this.history.length-this.sessionIndexStart,"down"===a?c=this.index+1:"up"===a&&(b=this.index),this.history.slice(b,c)},b}(Log),Traceback=function(a){function b(a){this.wdb=a,b.__super__.constructor.apply(this,arguments),this.$traceback=$(".traceback"),this.$traceback.on("click",".trace-line",this.select.bind(this))}return extend(b,a),b.prototype.select=function(a){var b;return b=$(a.currentTarget).attr("data-level"),this.wdb.select_trace(b),$(".mdl-layout__obfuscator").is(".is-visible")&&$(".mdl-layout").get(0).MaterialLayout.toggleDrawer(),!1},b.prototype.make_trace=function(a){var b,c,d,e,f,g,h,i,j,k,l;for(this.clear(),this.show(),l=[],g=0,i=a.length;g<i;g++){for(f=a[g],d=$("<a>",{class:"trace-line ellipsis mdl-list__item mdl-list__item--three-line trace-"+f.level}).attr("data-level",f.level).attr("title",'File "'+f.file+'", line '+f.lno+", in "+f.function+"\n    "+f.code),k=this.wdb.source.breakpoints[f.file]||[],h=0,j=k.length;h<j;h++)if(e=k[h],!(e.cond||e.fun||e.lno)){d.addClass("breakpoint");break}f.current&&d.addClass("real-selected"),b=$("<div>",{class:"mdl-list__item-primary-content"}),b.append($("<div>",{class:"ellipsis"}).text(f.function)),b.append($("<div>",{class:"mdl-list__item-text-body"}).append(c=$("<div>",{class:"ellipsis"})).append($("<div>",{class:"ellipsis"}).text(f.file.split("/").slice(-1)[0]+":"+f.lno).prepend($("<i>",{class:"material-icons"}).text(this.get_fn_icon(f.file))))),this.wdb.code(c,f.code,["ellipsis"]),d.append(b),l.push(this.$traceback.prepend(d))}return l},b.prototype.hide=function(){return this.$traceback.addClass("hidden")},b.prototype.show=function(){return this.$traceback.removeClass("hidden")},b.prototype.clear=function(){return this.$traceback.empty()},b.prototype.get_fn_icon=function(a){return~a.indexOf("site-packages")?"library_books":a.startsWith(this.wdb.cwd)||"/"!==a[0]?"star":a.startsWith("/home/")?"home":a.startsWith("/usr/lib")&&~a.indexOf("/python")?"lock":"cloud"},b}(Log),Interpreter=function(a){function b(a){this.wdb=a,b.__super__.constructor.apply(this,arguments),this.$terminal=$(".terminal").on("click",function(a){return function(){if(!getSelection().toString())return a.focus()}}(this)).on("click","a.inspect",this.inspect.bind(this)),this.$scrollback=$(".scrollback").on("click",".short.close",this.short_open.bind(this)).on("click",".short.open",this.short_close.bind(this)).on("click",".toggle",this.toggle_visibility.bind(this))}return extend(b,a),b.prototype.scroll=function(a){return null==a&&(a=null),a?void this.$terminal.scrollTop(this.$terminal.scrollTop()+a*this.$terminal.height()):this.wdb.prompt.$container.get(0).scrollIntoView({block:"end",behavior:"smooth"})},b.prototype.clear=function(){return this.$scrollback.empty()},b.prototype.write=function(a){return this.$scrollback.append(a)},b.prototype.inspect=function(a){return this.wdb.inspect($(a.currentTarget).attr("href"))},b.prototype.short_open=function(a){return $(a.currentTarget).addClass("open").removeClass("close").next(".long").show("fast")},b.prototype.short_close=function(a){return $(a.currentTarget).addClass("close").removeClass("open").next(".long").hide("fast")},b.prototype.toggle_visibility=function(a){return $(a.currentTarget).add($(a.currentTarget).next()).toggleClass("closed","shown")},b.prototype.focus=function(a){var b;return b=this.$terminal.scrollTop(),this.wdb.prompt.focus(),this.$terminal.scrollTop(b)},b}(Log),Prompt=function(a){function b(a){this.wdb=a,b.__super__.constructor.apply(this,arguments),this.$container=$(".prompt"),this.history=new History(this),this.code_mirror=CodeMirror(function(a){return function(b){return a.$code_mirror=$(b),a.$container.prepend(b)}}(this),{value:"",theme:"default",language:"python",viewportMargin:1/0,lineWrapping:!0,autofocus:!0,specialChars:/[\u0000-\u0019\u00a0\u00ad\u200b-\u200f\u2028\u2029\ufeff]/}),this.code_mirror.on("changes",this.changes.bind(this)),CodeMirror.registerHelper("hint","jedi",function(a){return function(b,c,d){var e,f,g,h,i,j;if(e=b.getCursor(),j=b.getTokenAt(e),!b.getValue().startsWith(".")||2!==b.getValue().length){if(f=CodeMirror.Pos(e.line,j.start),i=CodeMirror.Pos(e.line,j.end),"."===b.getValue())return void c({from:f,to:i,list:function(){var a,b;a={a:"History",b:"Break",c:"Continue",d:"Dump",e:"Edition",f:"Find",g:"Clear",h:"Help",i:"Display",j:"Jump",k:"Clear",l:"Breakpoints",m:"Restart",n:"Next",o:"Open",q:"Quit",r:"Return",s:"Step",t:"Tbreak",u:"Until",w:"Watch",x:"Diff",z:"Unbreak"},b=[];for(h in a)hasProp.call(a,h)&&(g=a[h],b.push({text:"."+h,displayText:"."+h+" <i>"+this.leftpad("("+g+")",14)+"</i>  ",render:function(a,b,c){return $(a).html(c.displayText)}}));return b}.call(a)});if(d.completeSingle||j.string.match(/[\w\.\(\[\{]/))return a.wdb.ws.send("Complete",{source:b.getValue(),pos:a.code_mirror.getRange({line:0,ch:0},e).length,line:e.line+1,column:e.ch,manual:d.completeSingle}),a.completion={cur:e,tok:j,from:f,to:i,callback:c}}}}(this)),this.code_mirror.addKeyMap({Enter:this.newLineOrExecute.bind(this),Up:this.history.up.bind(this.history),Down:this.history.down.bind(this.history),"Ctrl-C":this.abort.bind(this),"Ctrl-D":function(a){return function(){if(!a.get())return a.wdb.die()}}(this),"Ctrl-F":function(){},"Ctrl-R":function(a){return function(){return a.searchBack()}}(this),"Ctrl-S":function(a){return function(){return a.searchBack(!1)}}(this),"Ctrl-K":"killLine","Ctrl-L":this.wdb.cls.bind(this.wdb),"Ctrl-Enter":"newlineAndIndent","Alt-Backspace":"delGroupBefore","Ctrl-Space":this.triggerAutocomplete.bind(this),"Ctrl-Up":function(a){return function(){return a.insertHistory("up")}}(this),"Ctrl-Down":function(a){return function(){return a.insertHistory("down")}}(this),PageUp:"goLineUp",PageDown:"goLineDown",PageDown:"goLineDown","Shift-PageUp":function(a){return function(){return a.wdb.interpreter.scroll(-1)}}(this),"Shift-PageDown":function(a){return function(){return a.wdb.interpreter.scroll(1)}}(this),Tab:function(a){return function(b,c){var d,e,f;return d=a.code_mirror.getCursor(),e=a.code_mirror.getRange({line:d.line,ch:0},d),e.trim()?a.triggerAutocomplete(b,c):(f=Array(a.code_mirror.getOption("indentUnit")+1).join(" "),a.code_mirror.replaceSelection(f))}}(this)}),this.code_mirror.on("keyup",function(a){return function(b,c){var d;if(b.getValue()&&!(8<(d=c.keyCode)&&d<42))return CodeMirror.commands.autocomplete(b,CodeMirror.hint.jedi,{async:!0,completeSingle:!1,extraKeys:{PageUp:"goPageUp",PageDown:"goPageDown",Home:"goLineStartSmart",Up:function(a,b){return b._dirty=!0,b.moveFocus(-1)},Down:function(a,b){return b._dirty=!0,b.moveFocus(1)},Enter:function(b,c){return c._dirty?c.pick():a.newLineOrExecute(b)},Right:function(a,b){return b._dirty?b.pick():CodeMirror.commands.goCharRight(a)},End:"goLineEnd"}})}}(this))}return extend(b,a),b.prototype.complete=function(a){var b,c,d,e;return a.completions&&this.completion?(c=this.completion.cur,e=this.completion.tok,d={from:CodeMirror.Pos(c.line,e.start),to:CodeMirror.Pos(c.line,e.end),list:function(){var d,e,f,g;for(f=a.completions,g=[],d=0,e=f.length;d<e;d++)b=f[d],g.push({text:b.base+b.complete,from:CodeMirror.Pos(c.line,c.ch-b.base.length),to:c,_completion:b,render:function(a,b,c){var d,e;return d=c._completion,e="<b>"+d.base+"</b>"+d.complete,$(a).html(e)}});return g}()},CodeMirror.on(d,"shown",function(a){return function(){var b;return b=a.code_mirror.state.completionActive.options.completeSingle?"triggered":"auto",$(a.code_mirror.state.completionActive.widget.hints).addClass(b)}}(this)),void this.completion.callback(d)):a.imports?CodeMirror.commands.autocomplete(this.code_mirror,function(b,c){var d;return{from:CodeMirror.Pos(0,0),to:CodeMirror.Pos(0,0),list:function(){var b,c,e,f;for(e=a.imports,f=[],b=0,c=e.length;b<c;b++)d=e[b],f.push({text:d,from:CodeMirror.Pos(0,0),to:CodeMirror.Pos(0,0),render:function(a,b,c){var d;return d="<em>"+c.text+"</em>",$(a).html(d)}});return f}()}},{async:!1,completeSingle:!1}):void 0},b.prototype.triggerAutocomplete=function(a,b){return CodeMirror.commands.autocomplete(a,CodeMirror.hint.jedi,{async:!0,extraKeys:{Right:function(a,b){return b.pick()}}})},b.prototype.newLineOrExecute=function(a){var b;if(b=a.getValue().trim())return a.setOption("readOnly","nocursor"),this.$container.addClass("loading"),this.wdb.execute(b)},b.prototype.focus=function(){return this.code_mirror.focus()},b.prototype.focused=function(){return this.$code_mirror.hasClass("CodeMirror-focused")},b.prototype.abort=function(){return this.history.reset(),this.set("")},b.prototype.ready=function(a){var b;return null==a&&(a=!1),a?this.code_mirror.execCommand("newlineAndIndent"):(b=this.code_mirror.getValue().trim(),this.history.historize(b),this.history.reset(),this.set("")),this.unlock()},b.prototype.unlock=function(){return this.$container.removeClass("loading"),this.code_mirror.setOption("readOnly",!1),this.focus()},b.prototype.get=function(){return this.code_mirror.getValue()},b.prototype.set=function(a){return this.code_mirror.setValue(a)},b.prototype.leftpad=function(a,b,c){var d,e,f,g;for(null==c&&(c=" "),f=b-a.length,d=e=0,g=f;0<=g?e<=g:e>=g;d=0<=g?++e:--e)a=c+a;return a},b.prototype.searchBack=function(a){var b;return null==a&&(a=!0),this.$code_mirror.addClass("extra-dialog"),b=this.code_mirror.openDialog('<span class="search-dialog-title">\n  Search '+(a?"backward":"forward")+':\n</span>\n<input type="text" style="width: 10em" class="CodeMirror-search-field"/>',function(a){return function(b,c){return a.history.commitSearch()}}(this),{bottom:!0,onInput:function(a){return function(b,c,d){if(c)return a.history.resetSearch(),$(".CodeMirror-search-field").toggleClass("not-found",c&&!a.history[d.back?"searchNext":"searchPrev"](c))}}(this),onKeyDown:function(a){return function(b,c,d){return(82===b.keyCode&&b.ctrlKey||83===b.keyCode&&b.altKey)&&(d.back=!0,$(".search-dialog-title").text("Search backward:"),$(".CodeMirror-search-field").toggleClass("not-found",c&&!a.history.searchNext(c)),b.preventDefault(),b.stopPropagation()),(83===b.keyCode&&b.ctrlKey||82===b.keyCode&&b.altKey)&&(d.back=!1,$(".search-dialog-title").text("Search forward:"),$(".CodeMirror-search-field").toggleClass("not-found",c&&!a.history.searchPrev(c)),b.preventDefault(),b.stopPropagation()),67===b.keyCode&&b.ctrlKey&&d(),!1}}(this),onClose:function(a){return function(b){return a.history.rollbackSearch(),a.$code_mirror.removeClass("extra-dialog")}}(this)}),b.back=a},b.prototype.insert=function(a){return this.code_mirror.replaceRange(a,this.code_mirror.getCursor())},b.prototype.changes=function(){return this.wdb.interpreter.scroll()},b.prototype.insertHistory=function(a){var b;return b=this.history.getHistory(a).reverse().join("\n"),this.history.reset(),this.set(b)},b}(Log),Watchers=function(a){function b(a){this.wdb=a,b.__super__.constructor.apply(this,arguments),this.$watchers=$(".watchers").on("click",".watching .name",this.unwatch.bind(this))}return extend(b,a),b.prototype.unwatch=function(a){var b;return b=$(a.currentTarget).closest(".watching").attr("data-expr"),this.wdb.unwatch(b)},b.prototype.updateAll=function(a){var b,c;for(c in a)hasProp.call(a,c)&&(b=a[c],this.update(c,b));return this.$watchers.find(".watching:not(.updated)").remove(),this.$watchers.find(".watching").removeClass("updated")},b.prototype.update=function(a,b){var c,d,e;return e=this.$watchers.find(".watching").filter(function(b){return $(b).attr("data-expr")===a}),e.length?(e.find(".value code").remove(),this.wdb.code(e.find(".value"),b.toString(),[],!0)):(c=$("<code>",{class:"name"}),d=$("<div>",{class:"value"}),this.$watchers.append(e=$("<div>",{class:"watching"}).attr("data-expr",a).append(c.text(a),$("<code>").text(": "),d)),this.wdb.code(d,b.toString(),[],!0)),e.addClass("updated")},b}(Log),Switch=function(a){function b(a){this.wdb=a,b.__super__.constructor.apply(this,arguments),this.$trace=$(".trace"),this.$switches=$(".switch").click(function(a){return function(b){return a.switch($(b.currentTarget))}}(this)),this.$command=$(".command").click(function(a){return function(b){return a.command($(b.currentTarget))}}(this)),this.$source=$(".source"),this.$interpreter=$(".interpreter")}return extend(b,a),b.prototype.switch=function(a){if(a.is(".power")){if(a.is(".off"))return this.wdb.disable();if(a.is(".on"))return parent.postMessage("activate","*")}else if(a.is(".code")){if(a.is(".off"))return this.open_code();if(a.is(".on"))return this.close_code()}else if(a.is(".term")){if(a.is(".off"))return this.open_term();if(a.is(".on"))return this.close_term()}},b.prototype.open_trace=function(){return this.$trace.addClass("mdl-layout--fixed-drawer")},b.prototype.close_trace=function(){return this.$trace.removeClass("mdl-layout--fixed-drawer")},b.prototype.open_code=function(){return this.$switches.filter(".code").removeClass("off").addClass("on").removeClass("mdl-button--accent"),this.$source.removeClass("hidden"),this.wdb.source.size()},b.prototype.close_code=function(){return this.$switches.filter(".code").removeClass("on").addClass("off").addClass("mdl-button--accent"),this.$source.addClass("hidden"),this.wdb.source.size()},b.prototype.open_term=function(){return this.$switches.filter(".term").removeClass("off").addClass("on").removeClass("mdl-button--accent"),this.$interpreter.removeClass("hidden"),this.wdb.source.size()},b.prototype.close_term=function(){return this.$switches.filter(".term").removeClass("on").addClass("off").addClass("mdl-button--accent"),this.$interpreter.addClass("hidden"),this.wdb.source.size()},b.prototype.command=function(a){return this.wdb.execute("."+a.attr("data-command"))},b}(Log),help='<div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">\n  <div class="mdl-tabs__tab-bar">\n      <a href="#help-stepping" class="mdl-tabs__tab is-active">Stepping</a>\n      <a href="#help-breakpoints" class="mdl-tabs__tab">Breakpoints</a>\n      <a href="#help-inspecting" class="mdl-tabs__tab">Inspecting</a>\n      <a href="#help-prompt" class="mdl-tabs__tab">Prompt</a>\n      <a href="#help-misc" class="mdl-tabs__tab">Misc</a>\n  </div>\n\n  <div class="mdl-tabs__panel is-active" id="help-stepping">\n    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">\n      <tr>\n        <td class="cmd">\n          <samp>.s</samp> or <kbd>Alt</kbd> + <kbd>↓</kbd> or <kbd>F11</kbd>\n        </td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Step into\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd">\n          <samp>.n</samp> or <kbd>Alt</kbd> + <kbd>→</kbd> or <kbd>F10</kbd>\n        </td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Step over (Next)\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd">\n          <samp>.u</samp> or <kbd>Alt</kbd> + <kbd>←</kbd> or <kbd>F7</kbd>\n        </td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Until (Next over loops)\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd">\n          <samp>.r</samp> or <kbd>Alt</kbd> + <kbd>↑</kbd> or <kbd>F9</kbd>\n        </td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Step out (Return)\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd">\n          <samp>.c</samp> or <kbd>Alt</kbd> + <kbd>Enter</kbd> or <kbd>F8</kbd>\n        </td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Continue\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><samp>.j</samp> lineno</td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Jump to lineno (Must be at bottom frame and in the same function)\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><samp>.q</samp></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Quit\n        </td>\n      </tr>\n    </table>\n    <aside class="note">\n      All commands are prefixed with a dot and can be\n      executed with <kbd>Alt</kbd> + <kbd>the-command-letter</kbd>,\n      i.e.: <kbd>Alt</kbd> + <kbd>h</kbd>\n    </aside>\n  </div>\n  <div class="mdl-tabs__panel" id="help-breakpoints">\n    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">\n      <tr>\n        <td class="cmd"><samp>.b</samp> arg</td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Set a session breakpoint\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><samp>.t</samp> arg</td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Set a temporary breakpoint\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><samp>.z</samp> arg</td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Delete existing breakpoint\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><samp>.l</samp></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          List active breakpoints\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd">Breakpoint argument format</td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          <code>[file/module][:lineno][#function][,condition]</code>\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><code>[file]</code></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Break if any line of <code>file</code> is executed</td>\n      </tr>\n      <tr>\n        <td class="cmd"><code>[file]:lineno</code></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Break on <code>file</code> at <code>lineno</code></td>\n      </tr>\n      <tr>\n        <td class="cmd"><code>[file][:lineno],condition</code></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n            Break on <code>file</code> at <code>lineno</code> if\n            <code>condition</code> is <code>True</code>\n            (ie: <code>i == 10)</code></td>\n      </tr>\n      <tr>\n        <td class="cmd"><code>[file]#function</code></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Break when inside <code>function</code> function</td>\n      </tr>\n    </table>\n    <aside class="note">\n      File is always current file by default and you can also\n      specify a module like <code>logging.config</code>.\n    </aside>\n  </div>\n  <div class="mdl-tabs__panel" id="help-inspecting">\n    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">\n    <tr>\n      <td class="cmd"><samp>.a</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Echo all typed commands in the current debugging session\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.d</samp> expression</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Dump the result of expression in a table\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.w</samp> expression</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Watch expression in curent file (Click on the name to remove)\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.i</samp> [mime/type;]expression</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Display the result in an embed, mime type defaults to "text/html"\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.x</samp> left ? right</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Display the difference between the pretty print of \'left\' and \'right\'\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.x</samp> left <> right</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Display the difference between the repr of \'left\' and \'right\'\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.f</samp> key in expression</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Search recursively the presence of key in expression object tree\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.f</samp> test of expression</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Search recursively values that match test in expression inner tree.\n        i.e.: .f type(x) == int of sys\n      </td>\n    </tr>\n  </table>\n</div>\n<div class="mdl-tabs__panel" id="help-prompt">\n  <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">\n    <tr>\n      <td class="cmd">iterable!sthg</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        If <a href="https://github.com/paradoxxxzero/cutter">\n          cutter\n        </a> is installed, executes cut(iterable).sthg\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd">expr >! file</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Write the result of expr in file\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd">!< file</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Eval the content of file\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><kbd>Enter</kbd></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Eval the current selected text in page,\n        useful to eval code in the source\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><kbd>Shift</kbd> + <kbd>Enter</kbd></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Insert the current selected text in page in the prompt\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><kbd>Ctrl</kbd> + <kbd>Enter</kbd></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Force multiline prompt\n      </td>\n    </tr>\n  </table>\n</div>\n<div class="mdl-tabs__panel" id="help-misc">\n  <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">\n    <tr>\n      <td class="cmd"><samp>.h</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Get some help\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.m</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Restart program\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.e</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Toggle file edition mode\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.o</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Try to open file in external ($EDITOR / $VISUAL / xdg-open) editor.\n        <br>\n        Add an argument (or hold shift with alt+o) if your editor does not\n        support the file:lno:col syntax.\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.g</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Clear scrollback\n      </td>\n    </tr>\n  </table>\n</div>',
Wdb=function(a){function b(){b.__super__.constructor.apply(this,arguments),this.started=!1,this.cwd=null,this.file_cache={},this.last_cmd=null,this.evalTime=null,this.ws=new Websocket(this,$("[data-uuid]").attr("data-uuid")),this.traceback=new Traceback(this),this.source=new Source(this),this.interpreter=new Interpreter(this),this.prompt=new Prompt(this),this.switch=new Switch(this),this.watchers=new Watchers(this),this.$patience=$(".patience"),$(window).on("beforeunload",this.unload.bind(this))}return extend(b,a),b.prototype.__version__="3.1.0",b.prototype.opening=function(){return this.started||($(window).on("keydown",this.global_key.bind(this)),this.started=!0),this.ws.send("Start"),this.switch.open_term()},b.prototype.working=function(){return $("body,.activity").addClass("is-active")},b.prototype.chilling=function(){return $("body,.activity").removeClass("is-active")},b.prototype.done=function(){return this.interpreter.scroll(),this.prompt.ready(),this.chilling()},b.prototype.init=function(a){var b,c,d,e,f,g,h;for(a.version!==this.constructor.prototype.__version__&&this.print({for:"Client Server version mismatch !",result:"Server is "+this.constructor.prototype.__version__+" and Client is "+(a.version||"<= 2.0")}),this.cwd=a.cwd,d=a.breaks,h=[],e=0,f=d.length;e<f;e++)c=d[e],null==(b=this.source.breakpoints)[g=c.fn]&&(b[g]=[]),h.push(this.source.breakpoints[c.fn].push(c));return h},b.prototype.title=function(a){return $(".title").text(a.title).attr("title",a.title),$(".subtitle").text(a.subtitle).attr("title",a.subtitle)},b.prototype.trace=function(a){return this.switch.open_trace(),this.traceback.make_trace(a.trace)},b.prototype.select_trace=function(a){return this.ws.send("Select",a)},b.prototype.selectcheck=function(a){return a.name in this.file_cache?(a.file=this.file_cache[a.name],this.select(a)):this.ws.send("File",a.name)},b.prototype.select=function(a){var b;return b=a.frame,this.switch.open_code(),$(".trace-line").removeClass("selected"),$(".trace-"+b.level).addClass("selected"),this.file_cache[a.name]=a.file,this.source.open(a,b),this.done()},b.prototype.ellipsize=function(a){return a.find("span.cm-string").each(function(){var a;if(a=$(this).text(),a.length>128)return $(this).text(""),$(this).append($('<span class="short close">').text(a.substr(0,128))),$(this).append($('<span class="long">').text(a.substr(128)))})},b.prototype.code=function(a,b,c,d,e,f){var g,h,i,j,k;if(null==c&&(c=[]),null==d&&(d=!1),null==e&&(e=null),null==f&&(f="python"),d)h="<"!==b[0]||">"!==b.slice(-1)?$("<div>",{class:"out"}).html(b):$(b),a.append(h),h.add(h.find("*")).contents().filter(function(){return 3===this.nodeType&&this.nodeValue.length>0&&!$(this.parentElement).closest("thead").length}).wrap("<code>").parent().each(function(a){return function(b,d){var g,h,i,j;for(g=$(d),g.addClass("waiting_for_hl").addClass("cm-s-default"),i=0,j=c.length;i<j;i++)h=c[i],g.addClass(h);return e&&g.attr("title",e),setTimeout(function(){return CodeMirror.runMode(g.text(),f,g.get(0)),g.removeClass("waiting_for_hl"),a.ellipsize(g)},50)}}(this));else{for(g=$("<code>",{class:"cm-s-default"}),j=0,k=c.length;j<k;j++)i=c[j],g.addClass(i);e&&g.attr("title",e),a.append(g),CodeMirror.runMode(b,f,g.get(0)),this.ellipsize(g)}return g},b.prototype.execute=function(a){var b,c,d,e,f,g;return b=function(a){return function(){return a.ws.send.apply(a.ws,arguments),a.last_cmd=arguments,a.working()}}(this),0===a.indexOf(".")?(g=a.indexOf(" "),g>-1?(d=a.substr(1,g-1),c=a.substr(g+1)):(d=a.substr(1),c=""),f=function(){switch(d){case"a":return this.printHistory();case"b":return this.toggle_break(c);case"c":return b("Continue");case"d":if(c)return b("Dump",c);break;case"e":return this.source.toggle_edition();case"f":if(c)return b("Find",c);break;case"g":return this.cls();case"h":return this.printHelp();case"i":if(c)return b("Display",c);break;case"j":if(c)return b("Jump",c);break;case"k":return this.clearHistory();case"l":return b("Breakpoints");case"m":return b("Restart");case"n":return b("Next");case"o":return this.source.external(!c);case"q":return b("Quit");case"r":return b("Return");case"s":return b("Step");case"t":return this.toggle_break(c,!0);case"u":return b("Until");case"w":if(c)return b("Watch",c);break;case"x":if(c)return b("Diff",c);break;case"z":return this.toggle_break(c,!1,!0)}}.call(this),void(f||this.prompt.unlock())):0===a.indexOf("?")?void b("Dump",a.slice(1).trim()):""===a&&this.last_cmd?void b.apply(this,this.last_cmd):a?(this.working(),this.ws.send("Eval",a),this.evalTime="undefined"!=typeof performance&&null!==performance?performance.now():void 0,this.$patience.text(this.pretty_time(0)),e=function(a){return function(){var b;return a.evalTime?(b=parseInt(1e3*(performance.now()-a.evalTime)),a.$patience.text(a.pretty_time(b)),requestAnimationFrame(e)):void a.$patience.text("")}}(this),requestAnimationFrame(e)):void 0},b.prototype.cls=function(){return this.interpreter.clear(),this.done()},b.prototype.printHistory=function(a){return this.print({for:"History",result:this.prompt.history.getSessionHistory().reverse().filter(function(a){return 0!==a.indexOf(".")}).join("\n")})},b.prototype.clearHistory=function(){return this.prompt.history.clear()},b.prototype.printHelp=function(){return this.dialog("Help",help),this.done()},b.prototype.print=function(a){var b,c,d,e,f,g;return this.evalTime&&(e=parseInt(1e3*(performance.now()-this.evalTime)),g=performance.now(),this.evalTime=null),b=$("<div>",{class:"printed scroll-line"}),this.interpreter.write(b),b.append(d=$("<div>")),this.code(b,a.for,["for prompted"]),c=$("<div>",{class:"result"}),b.append(c),this.code(c,a.result||" ",["val"],!0),f=parseInt(1e3*(performance.now()-g)),a.duration&&this.code(d,this.pretty_time(a.duration),["duration"],!1,"Total "+this.pretty_time(e)+" + "+this.pretty_time(f)+" of rendering"),this.done()},b.prototype.echo=function(a){var b,c;return b=$("<div>",{class:"echoed scroll-line"}),this.interpreter.write(b),this.code(b,a.for,["for prompted"]),c=$("<div>",{class:"result"}),b.append(c),this.code(c,a.val||"",["val"],!0,null,a.mode),this.done()},b.prototype.rawhtml=function(a){var b;return b=$("<div>",{class:"rawhtml scroll-line"}),this.interpreter.write(b),this.code(b,a.for,["for prompted"]),this.interpreter.write(a.val),this.done()},b.prototype.dump=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;g=$("<div>",{class:"dump scroll-line"}),this.interpreter.write(g),this.code(g,a.for,["for prompted"]),d=$("<div>"),j=$("<table>",{class:"mdl-data-table mdl-js-data-table mdl-shadow--2dp object"}).appendTo(d),e=$("<thead>",{class:"toggle closed"}).append($("<tr>").append($("<th>",{class:"core",colspan:2}).text("Core Members"))).appendTo(j),f=$("<tbody>",{class:"core closed"}).appendTo(j),h=$("<thead>",{class:"toggle closed"}).append($("<tr>").append($("<th>",{class:"method",colspan:2}).text("Methods"))).appendTo(j),i=$("<tbody>",{class:"method closed"}).appendTo(j),b=$("<thead>",{class:"toggle closed"}).append($("<tr>").append($("<th>",{class:"attr",colspan:2}).text("Attributes"))).appendTo(j),c=$("<tbody>",{class:"attr closed"}).appendTo(j),m=a.val;for(l in m)n=m[l],k=c,0===l.indexOf("__")&&l.indexOf("__",l.length-2)!==-1?k=f:n.type.indexOf("method")!==-1&&(k=i),k.append($("<tr>").append($("<td>",{class:"key"}).text(l)).append($("<td>",{class:"mdl-data-table__cell--non-numeric val"}).html(n.val)));return 0===f.find("tr").length&&(e.remove(),f.remove()),0===c.find("tr").length&&(b.remove(),c.remove()),0===i.find("tr").length&&(h.remove(),i.remove()),a.doc&&(j.append($("<thead>",{class:"toggle closed"}).append($("<tr>").append($("<th>",{class:"doc",colspan:2}).text("Documentation")))),$("<tbody>",{class:"doc closed"}).append($("<tr>").append($("<td>",{class:"mdl-data-table__cell--non-numeric doc",colspan:2}).text(a.doc))).appendTo(j)),a.source&&(j.append($("<thead>",{class:"toggle closed"}).append($("<tr>").append($("<th>",{class:"source",colspan:2}).text("Source")))),$("<tbody>",{class:"source closed"}).append($("<tr>").append($("<td>",{class:"mdl-data-table__cell--non-numeric source",colspan:2}).text(a.source))).appendTo(j)),componentHandler.upgradeElement(j.get(0)),this.code(g,d.html(),[],!0),this.done()},b.prototype.breakset=function(a){var b;return this.source.set_breakpoint(a),"."!==this.prompt.get()[0]||"b"!==(b=this.prompt.get()[1])&&"t"!==b?this.chilling():this.done()},b.prototype.breakunset=function(a){var b;return this.source.clear_breakpoint(a),"."!==this.prompt.get()[0]||"b"!==(b=this.prompt.get()[1])&&"t"!==b&&"z"!==b?this.chilling():this.done()},b.prototype.split=function(a,b){var c;return indexOf.call(a,b)>=0?(c=a.split(b),[c[0],c.slice(1).join(b).trim()]):[a,null]},b.prototype.toggle_break=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;for(null==b&&(b=!1),null==c&&(c=!1),d={lno:null,cond:null,fun:null,fn:null,temporary:b},n=a,j=this.split(n,","),n=j[0],d.cond=j[1],k=this.split(n,"#"),n=k[0],d.fun=k[1],l=this.split(n,":"),n=l[0],d.lno=l[1],d.fn=n||this.source.state.fn,d.lno=parseInt(d.lno)||null,g=!1,m=this.source.breakpoints[d.fn]||[],h=0,i=m.length;h<i;h++)if(f=m[h],f.fn===d.fn&&f.lno===d.lno&&f.cond===d.cond&&f.fun===d.fun&&(f.temporary===d.temporary||c)){g=!0,d=f;break}return g||c?(this.source.clear_breakpoint(d),e="Unbreak",d.temporary||(e="Broadcast|"+e),this.ws.send(e,d),void this.working()):(d.lno&&this.source.ask_breakpoint(d.lno),e="Break",b||(e="Broadcast|"+e),this.ws.send(e,d),this.working())},b.prototype.watched=function(a){return this.watchers.updateAll(a)},b.prototype.ack=function(){return this.done()},b.prototype.display=function(a){var b,c;return b=$("<div>",{class:"display scroll-line"}),this.interpreter.write(b),this.code(b,a.for,["for prompted"]),c=a.type.indexOf("image")>=0?$("<img>"):a.type.indexOf("audio")>=0?$("<audio>",{controls:"controls",autoplay:"autoplay"}):a.type.indexOf("video")>=0||a.type.indexOf("/ogg")>=0?$("<video>",{controls:"controls",autoplay:"autoplay"}):$("<iframe>"),c.addClass("display"),c.attr("src","data:"+a.type+";charset=UTF-8;base64,"+a.val),b.append(c),this.done()},b.prototype.suggest=function(a){if(a)return this.prompt.complete(a)},b.prototype.die=function(){if(this.title({title:"Dead",subtitle:"Program has exited"}),this.ws.ws.close(),$("body").addClass("is-dead"),!$("body").attr("data-debug"))return setTimeout(function(){return window.close()},10)},b.prototype.global_key=function(a){var b,c,d,e,f,g;if(this.source.rw)return!0;if(g=this.source.focused()&&this.source.code_mirror.getSelection(),a.altKey&&(65<=(d=a.keyCode)&&d<=90||37<=(e=a.keyCode)&&e<=40||13===a.keyCode)||118<=(f=a.keyCode)&&f<=122)return b=function(){switch(a.keyCode){case 37:case 118:return"u";case 13:case 119:return"c";case 38:case 120:return"r";case 39:case 121:return"n";case 40:case 122:return"s";default:return String.fromCharCode(a.keyCode)}}(),b=b.toLowerCase(),c="","b"!==b&&"t"!==b&&"z"!==b||(c+=" :"+this.source.state.lno),"i"===b&&(c=" "+g),"o"===b&&a.shiftKey&&(c=" !"),this.execute("."+b+c),!1;if(13===a.keyCode){if(this.prompt.focused())return;if(!g)return;return a.shiftKey?(this.prompt.insert(g),this.prompt.focus()):a.ctrlKey?this.ws.send("Watch",g):(this.prompt.history.historize(g),this.execute(g)),!1}},b.prototype.newline=function(){return this.prompt.ready(!0),this.chilling()},b.prototype.inspect=function(a){return this.ws.send("Inspect",a),this.working(),!1},b.prototype.unwatch=function(a){return this.ws.send("Unwatch",a),this.working()},b.prototype.paste_target=function(a){var b;return b=$(a.target).text().trim(),""===b||(a.shiftKey?void this.prompt.insert(b):a.ctrlKey?void this.ws.send("Watch",b):(this.prompt.history.historize(b),this.ws.send("Dump",b),this.working(),!1))},b.prototype.disable=function(){return this.ws.send("Disable")},b.prototype.shell=function(){return this.switch.close_trace(),this.switch.close_code(),this.switch.open_term(),this.done()},b.prototype.dialog=function(a,b){var c,d;return $(".modals").append(c=$('<dialog class="mdl-dialog">\n  <h3 class="mdl-dialog__title">'+a+'</h3>\n  <div class="mdl-dialog__content">\n    '+b+'\n  </div>\n  <div class="mdl-dialog__actions">\n    <button type="button" class="mdl-button dialog-close">Close</button>\n  </div>\n</dialog>')),c.find(".dialog-close").on("click",function(){return c.get(0).close(),c.remove()}),c.find(".mdl-tabs,.mdl-data-table").each(function(){return componentHandler.upgradeElement(this)}),c.on("close",function(a){return function(){return a.prompt.ready()}}(this)),d=c.get(0),"undefined"!=typeof dialogPolyfill&&null!==dialogPolyfill&&dialogPolyfill.registerDialog(d),d.showModal()},b.prototype.pretty_time=function(a){var b,c,d,e;return a<1e3?a+"μs":(a/=1e3,a<10?a.toFixed(2)+"ms":a<100?a.toFixed(1)+"ms":a<1e3?a.toFixed(0)+"ms":(a/=1e3,a<10?a.toFixed(2)+"s":a<60?a.toFixed(1)+"s":(e=function(a){return a=a.toString(),1===a.length?"0"+a:a},c=Math.floor(a/60),d=(a-60*c).toFixed(0),c<60?c+"m"+e(d)+"s":(b=Math.floor(c/60),c=(c-60*b).toFixed(0),b+"h"+e(c)+"m"+e(d)+"s"))))},b.prototype.unload=function(){return this.ws.ws.close()},b}(Log),$(function(){return window.wdb=new Wdb});